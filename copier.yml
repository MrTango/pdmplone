_subdirectory: template

_exclude:
    - "{% if _copier_operation == 'update' -%}instance/inituser{% endif %}"


# questions
project_name:
  type: str
  help: What is your Python project name?

plone_version:
  type: str
  help: Which Plone version you want to install?
  default: "6.1.1"

initial_zope_username:
  type: str
  help: Initial Zope username
  default: "admin"

initial_user_password:
  type: str
  help: Initial Zope password
  default: "admin"
  secret: true

db_storage:
  type: str
  help: Which storage type to be configured (direct=standalone)
  choices:
    - "direct"
    - "zeo"
    - "relstorage"
  default: "direct"

wsgi_listen:
  type: str
  help: WSGI address to listen on
  default: "localhost:8080"

wsgi_workers:
  type: int
  help: WSGI Workers
  default: 2

zeo_server_address:
  type: str
  help: ZEO Server address to listen on
  default: "localhost:8000"
  when: "{{ db_storage == 'zeo' }}"

zeoclient_shared_blob_dir:
  type: bool
  help: ZEO client shared blob dir?
  default: false
  when: "{{ db_storage == 'zeo' }}"

zeoclient_blob_cache_size:
  type: int
  help: ZEO client blob cache size in Bytes
  default: 6312427520
  when: "{{ db_storage == 'zeo' }}"


_message_after_copy: |
  Your project "{{ project_name }}" has been created here: {{ _copier_conf.dst_path | realpath }}

  Next steps:

  1. Change directory to the project root:

      $ cd {{ _copier_conf.dst_path }}

  2. Install

      $ uvx pdm install

  3. Start Zope instance

      $ uvx pdm run start_instance

  4. Open browser at http://localhost:8080

  5. Check README.md for more details


_tasks:
  - command: ["git", "init"]
    when: "{{ _copier_operation == 'copy' }}"
  - command: ["git", "add", "."]
    when: "{{ _copier_operation == 'copy' }}"
  - command: ["git", "commit", "-m", "'Copier template generated'"]
    when: "{{ _copier_operation == 'copy' }}"
  - command: ["git", "status"]
    when: "{{ _copier_operation == 'update' }}"